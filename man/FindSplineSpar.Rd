% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SubFunctions.R
\name{FindSplineSpar}
\alias{FindSplineSpar}
\title{Find Optimal Spline Smoothing Parameter (spar) via Multi-Objective Optimization}
\usage{
FindSplineSpar(
  x,
  y,
  spar_start,
  spar_end,
  spar_step,
  RMSE_weight,
  CV_weight,
  D1_weight,
  D2_weight,
  use_cv = TRUE,
  plot = TRUE
)
}
\arguments{
\item{x}{Numeric vector of the independent variable.}

\item{y}{Numeric vector of the response variable.}

\item{spar_start}{Numeric. The starting value for the \code{spar} sequence.}

\item{spar_end}{Numeric. The ending value for the \code{spar} sequence.}

\item{spar_step}{Numeric. The increment step for the \code{spar} sequence.}

\item{RMSE_weight}{Numeric. Weight assigned to the Root Mean Square Error.}

\item{CV_weight}{Numeric. Weight assigned to the Cross-Validation criterion.}

\item{D1_weight}{Numeric. Weight assigned to the first derivative total variation.}

\item{D2_weight}{Numeric. Weight assigned to the second derivative smoothness penalty.}

\item{use_cv}{Logical. Whether to use cross-validation in \code{smooth.spline}. Default is \code{TRUE}.}

\item{plot}{Logical. If \code{TRUE}, returns a diagnostic grid plot of all metrics. Default is \code{TRUE}.}
}
\value{
A named list containing:
\itemize{
\item \code{best_spar}: The optimized smoothing parameter.
\item \code{spar_data_info}: Data frame with raw metrics for each \code{spar}.
\item \code{spar_data_info_norm}: Data frame with normalized metrics and the final evaluation score.
\item \code{spar_data_info_plot}: A \code{patchwork} object (if \code{plot = TRUE})
showing metric trends and the selected \code{best_spar}.
}
}
\description{
This function iterates through a range of smoothing parameters (\code{spar}) to
find the optimal value based on a weighted evaluation score. The score combines
goodness-of-fit, cross-validation, and derivative-based smoothness metrics.
}
\details{
The function performs a grid search over \code{spar}. For each value, it calculates
metrics using \code{\link{GetSplineSparEvaValue}}. Metrics are then normalized
using max-min normalization:
\deqn{X_{norm} = \frac{X - min(X)}{max(X) - min(X)}}
The final evaluation score is the weighted sum of these normalized metrics. The
\code{spar} with the minimum score is selected as the \code{best_spar}.
}
\examples{
\dontrun{
result <- FindSplineSpar(
  x = intensity_x, y = intensity_y,
  spar_start = 0.1, spar_end = 1.5, spar_step = 0.05,
  RMSE_weight = 1, CV_weight = 1, D1_weight = 0.5, D2_weight = 0.5
)
# Access the plot
print(result$spar_data_info_plot)
}
}
