% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MainFunctions.R
\name{ValidateGlycanCompositionByIsotopePattern}
\alias{ValidateGlycanCompositionByIsotopePattern}
\title{Validate Glycan Compositions using MS1 Isotope Pattern Matching}
\usage{
ValidateGlycanCompositionByIsotopePattern(
  spectrum_matching_info,
  molecular_names = molecular_formula_name_default,
  molecular_formula_list = molecular_formula_list_default,
  ms_data,
  ms1_window_left,
  ms1_window_right,
  bin_width,
  threshold_iso_probalility = threshold_iso_probalility_default
)
}
\arguments{
\item{spectrum_matching_info}{A data frame containing initial matching results.
Required columns: \code{"ms1_spectrum_id"}, \code{"ms2_spectrum_id"}, and
\code{"ms2_precursor_mz"}. Typically the output from \code{FindPossibleGlycanComposition}.}

\item{molecular_names}{A character vector of names from \code{molecular_formula_list}
to be used for formula calculation (e.g., sugars and adducts).}

\item{molecular_formula_list}{A named character vector of molecular formulas for
monosaccharides, labels, and adducts.}

\item{ms_data}{A \code{Spectra} object containing the raw MS1 spectra.}

\item{ms1_window_left}{Numeric. The left (lower) m/z offset from the precursor
m/z to define the MS1 isolation window for isotope pattern extraction.}

\item{ms1_window_right}{Numeric. The right (upper) m/z offset from the precursor
m/z to define the MS1 isolation window.}

\item{bin_width}{Numeric. The bin width for m/z discretization during cosine
score calculation.}

\item{threshold_iso_probalility}{Numeric. The minimum relative abundance threshold
for theoretical isotopic peaks to be included in the comparison. Default is 0.01.}
}
\value{
A data frame (\code{tibble}) updated with isotope validation metrics.
Candidates with higher cosine scores represent better matches to the
experimental data.
}
\description{
This function validates candidate glycan compositions by comparing their theoretical
isotopic distributions with the observed MS1 spectra. It calculates a similarity
score (cosine score) between the predicted and actual isotope patterns to
identify the most likely glycan composition for each MS2 spectrum.
}
\details{
For each MS2 spectrum with multiple potential glycan candidates, the function
retrieves the corresponding MS1 scan. It then simulates the theoretical isotope
distribution based on the candidate's molecular formula and compares it to the
experimental peaks within the specified m/z window.
}
\examples{
\dontrun{
# Validate candidates using a 1 Da window on the left and 2 Da on the right
validated_results <- ValidateGlycanCompositionByIsotopePattern(
  spectrum_matching_info = candidate_list,
  ms_data = raw_spectra,
  ms1_window_left = 1.0,
  ms1_window_right = 2.5,
  bin_width = 0.05
)
}
}
