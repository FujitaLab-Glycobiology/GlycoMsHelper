% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MainFunctions.R
\name{FindSpectrumByDiagnosticFragments}
\alias{FindSpectrumByDiagnosticFragments}
\title{Identify Glycan Spectra via Diagnostic Fragment Logic}
\usage{
FindSpectrumByDiagnosticFragments(
  ms_data,
  ms_data_raw,
  diagnostic_frags_list = diagnostic_frags_list_default,
  diagnostic_frags_exp,
  ppm_val
)
}
\arguments{
\item{ms_data}{A \code{Spectra} object (typically denoised/processed) used for fragment screening.}

\item{ms_data_raw}{A \code{Spectra} object (typically raw) from which matched spectra will be extracted.}

\item{diagnostic_frags_list}{A named numeric vector of target m/z values for diagnostic fragments.
Defaults to \code{diagnostic_frags_list_default}.}

\item{diagnostic_frags_exp}{A character string representing a logical expression.
Names in this expression must match the names in \code{diagnostic_frags_list}.
Example: \code{"HexNAc & (HexNAc_ProA | dHex_HexNAc_ProA) & !Hex_HexNAc_ProA"}.}

\item{ppm_val}{Numeric. The mass tolerance in parts-per-million (ppm) for matching fragments.}
}
\value{
A list containing:
\itemize{
\item \code{spectrum_info}: A data frame containing metadata for matched MS1 and MS2 scans,
including boolean flags (\code{_flag}) for the presence of each diagnostic fragment.
\item \code{selected_ms_data}: A \code{Spectra} object containing only the identified
MS1 and MS2 spectra.
}
}
\description{
This function screens MS2 spectra for specific glycan diagnostic ions. It allows
users to define complex matching logic (e.g., AND, OR, NOT) to filter spectra
potentially containing glycans or specific glycan motifs.
}
\details{
The function evaluates the \code{diagnostic_frags_exp} by checking the presence of each
fragment in the \code{diagnostic_frags_list} within the specified \code{ppm_val} tolerance.
If a match is found, the function also identifies the preceding MS1 scan for that MS2 spectrum.
}
\examples{
\dontrun{
# Define custom diagnostic fragments
my_frags <- c(HexNAc = 204.0867, Neu5Ac = 291.0954)

# Filter spectra that MUST have HexNAc AND Neu5Ac
result <- FindSpectrumByDiagnosticFragments(
  ms_data = processed_data,
  ms_data_raw = raw_data,
  diagnostic_frags_list = my_frags,
  diagnostic_frags_exp = "HexNAc & Neu5Ac",
  ppm_val = 20
)

# View matched spectrum IDs
print(result$spectrum_info$ms2_spectrum_id)
}
}
