% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MainFunctions.R
\name{GetMonoisoAndIsotopologueRatio}
\alias{GetMonoisoAndIsotopologueRatio}
\title{Calculate Monoisotopic and M+1 Isotopologue Ratios for Glycan Libraries}
\usage{
GetMonoisoAndIsotopologueRatio(
  glycan_lib,
  molecular_names,
  molecular_formula_list,
  monosaccharides_names,
  threshold_iso_probalility
)
}
\arguments{
\item{glycan_lib}{A data frame containing glycan compositions. Must include a \code{total_charge}
column and columns corresponding to the names in \code{molecular_names}.}

\item{molecular_names}{A character vector of column names in \code{glycan_lib} that
represent the counts of specific molecular building blocks (e.g., "Hex", "HexNAc").}

\item{molecular_formula_list}{A named list where keys match \code{molecular_names}
and values are their corresponding chemical formulas (e.g., \code{list(Hex = "C6H10O5")}).}

\item{monosaccharides_names}{A character vector of column names used to construct
a human-readable composition string (e.g., "Hex3HexNAc2").}

\item{threshold_iso_probalility}{A numeric value specifying the probability threshold
for \code{enviPat::isopattern}. Peaks with relative abundance below this value are ignored.}
}
\value{
A named list containing:
\itemize{
\item \code{glycan_monosaccharides_library_isotopic_info}: The original \code{glycan_lib}
augmented with columns for theoretical m/z, abundance, and the monoisotopic/isotopologue ratio.
\item \code{isotopic_distribution_plot}: A \code{ggplot2} object showing the relationship
between monoisotopic m/z and the abundance ratio, colored by charge state.
}
}
\description{
This function iterates through a glycan library to calculate theoretical isotopic distributions
based on chemical formulas. It identifies the monoisotopic peak and the most abundant
M+1 isotopologue, calculates their abundance ratio, and generates a scatter plot of monoisotopic m/z versus the
monoisotopic-to-\eqn{M+1} abundance ratio, colored by charge state.
}
\details{
The function utilizes the \code{enviPat} package to predict isotopic patterns. It specifically
identifies the monoisotopic peak by ensuring zero counts of "heavy" isotopes (e.g., 13C, 15N).
The M+1 isotopologue is identified as the most abundant peak within a specific mass tolerance
(\eqn{1/z \pm tolerance}) from the monoisotopic peak.

#' The function adds the following columns to \code{glycan_lib}:
\itemize{
\item \code{glycan_string}
\item \code{ion_formula}
\item \code{theoretical_monoisotopic_mz}
\item \code{theoretical_isotopologue_mz}
\item \code{theoretical_monoisotopic_abundance}
\item \code{theoretical_isotopologue_abundance}
\item \code{theoretical_monoisotopic_isotopologue_abundance_ratio}
}

#' If a row cannot produce a valid molecular formula, the added fields are set to \code{NA}.
The function stops with an error if it detects zero or multiple monoisotopic peaks or if it cannot
uniquely identify the most abundant \eqn{M+1} isotopologue under the defined criteria.
}
\examples{
\dontrun{
# Define formula list
formula_list <- list(Hex = "C6H10O5", HexNAc = "C8H13NO5", Fuc = "C6H10O4")

# Run calculation
results <- GetMonoisoAndIsotopologueRatio(
  glycan_lib = my_data,
  molecular_names = c("Hex", "HexNAc", "Fuc"),
  monosaccharides_names = c("Hex", "HexNAc", "Fuc"),
  molecular_formula_list = formula_list,
  threshold_iso_probalility = 0.0001
)

# Access plot
print(results$isotopic_distribution_plot)
}
}
